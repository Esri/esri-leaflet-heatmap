{"version":3,"file":"esri-leaflet-heatmap-debug.js","sources":["../src/HeatmapFeatureLayer.js"],"sourcesContent":["import L from 'leaflet';\r\nimport { FeatureManager } from 'esri-leaflet';\r\nimport packageInfo from '../package.json';\r\nvar version = packageInfo.version;\r\nexport { version as VERSION };\r\n\r\nexport var FeatureLayer = FeatureManager.extend({\r\n  /**\r\n   * Constructor\r\n   */\r\n\r\n  initialize: function (options) {\r\n    FeatureManager.prototype.initialize.call(this, options);\r\n\r\n    options = L.setOptions(this, options);\r\n\r\n    this._cache = {};\r\n    this._active = {};\r\n\r\n    this.heat = window.L.heatLayer([], options);\r\n  },\r\n\r\n  /**\r\n   * Layer Interface\r\n   */\r\n\r\n  onAdd: function (map) {\r\n    FeatureManager.prototype.onAdd.call(this, map);\r\n    this._map.addLayer(this.heat);\r\n  },\r\n\r\n  onRemove: function (map) {\r\n    FeatureManager.prototype.onRemove.call(this, map);\r\n    this._map.removeLayer(this.heat);\r\n  },\r\n\r\n  /**\r\n   * Feature Managment Methods\r\n   */\r\n\r\n  createLayers: function (features) {\r\n    for (var i = features.length - 1; i >= 0; i--) {\r\n      var geojson = features[i];\r\n      var id = geojson.id;\r\n      var latlng = new L.LatLng(geojson.geometry.coordinates[1], geojson.geometry.coordinates[0]);\r\n      this._cache[id] = latlng;\r\n\r\n      // add the layer if it is within the time bounds or our layer is not time enabled\r\n      if (!this._active[id] && (!this.options.timeField || (this.options.timeField && this._featureWithinTimeRange(geojson)))) {\r\n        this._active[id] = latlng;\r\n        this.heat._latlngs.push(latlng);\r\n      }\r\n    }\r\n\r\n    this.heat.redraw();\r\n  },\r\n\r\n  addLayers: function (ids) {\r\n    for (var i = ids.length - 1; i >= 0; i--) {\r\n      var id = ids[i];\r\n      if (!this._active[id]) {\r\n        var latlng = this._cache[id];\r\n        this.heat._latlngs.push(latlng);\r\n        this._active[id] = latlng;\r\n      }\r\n    }\r\n    this.heat.redraw();\r\n  },\r\n\r\n  removeLayers: function (ids, permanent) {\r\n    var newLatLngs = [];\r\n    for (var i = ids.length - 1; i >= 0; i--) {\r\n      var id = ids[i];\r\n      if (this._active[id]) {\r\n        delete this._active[id];\r\n      }\r\n      if (this._cache[id] && permanent) {\r\n        delete this._cache[id];\r\n      }\r\n    }\r\n\r\n    for (var latlng in this._active) {\r\n      newLatLngs.push(this._active[latlng]);\r\n    }\r\n\r\n    this.heat.setLatLngs(newLatLngs);\r\n  },\r\n\r\n  setOptions: function (options) {\r\n    this.heat.setOptions(options);\r\n  },\r\n\r\n  redraw: function () {\r\n    this.heat.redraw();\r\n  }\r\n\r\n});\r\n\r\nexport function featureLayer (options) {\r\n  return new FeatureLayer(options);\r\n}\r\n\r\nexport default featureLayer;\r\n"],"names":["FeatureManager","L"],"mappings":"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"}